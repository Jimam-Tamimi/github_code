{% load static %}

<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title></title>

    <meta name="keywords" content="HTML5 Template" />
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="">

    <!-- Css Styles -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" type="text/css">

    <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css' %}"
        integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
        crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/fontawesome.min.css' %}"
        integrity="sha512-kJ30H6g4NGhWopgdseRb8wTsyllFUYIx3hiUwmGAkgA9B/JbzUBDQVr2VVlWGde6sdBVOG7oU8AL35ORDuMm8g=="
        crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/js/fontawesome.min.js"
        integrity="sha512-kI12xOdWTh/nL2vIx5Yf3z/kJSmY+nvdTXP2ARhepM/YGcmo/lmRGRttI3Da8FXLDw0Y9hRAyZ5JFO3NrCvvXA=="
        crossorigin="anonymous"></script>

    <!-- souk CSS -->
    <link rel="stylesheet" href="{% static 'assets/css/style-liberty.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/style-starter.css' %}">

    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/slicknav.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/style.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/cart.css' %}">
    <link href="{% static 'css/slider_item.css' %}" rel="stylesheet">
    <link rel="stylesheet" type="text/css"
        href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.3/animate.min.css">

    <!--page-icon------------>
    <link rel="shortcut icon" href="{% static 'images/logo.png' %}">
    <link rel="stylesheet" href="{% static 'css/lightSlider.css' %}">
    <script src="https://code.jquery.com/jquery-3.5.1.js"
        integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightslider/1.1.6/js/lightslider.js"
        integrity="sha512-sww7U197vVXpRSffZdqfpqDU2SNoFvINLX4mXt1D6ZecxkhwcHmLj3QcL2cJ/aCxrTkUcaAa6EGmPK3Nfitygw=="
        crossorigin="anonymous"></script>

    <script src="https://kenwheeler.github.io/slick/slick/slick.js"></script>

    <!-- Main CSS File -->
    <link rel="stylesheet" href="{% static 'assets/css/style.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'assets/fonts/fontawesome.css' %}">
    <link rel="stylesheet" href="{% static 'css/c2.css' %}">
    <link rel="stylesheet" href="{% static 'css/extra.css' %}">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"
        integrity="sha512-yHknP1/AwR+yx26cB1y0cjvQUMvEa2PFzt1c9LlS4pRQ5NOTZFWbhBig+X9G9eYW/8m0/4OXNx8pxJ6z57x0dw=="
        crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"
        integrity="sha512-XtmMtDEcNz2j7ekrtHvOVR4iwwaD6o/FUJe6+Zq+HgcCsk3kj4uSQQR8weQ2QVj1o0Pk6PwYLohm206ZzNfubg=="
        crossorigin="anonymous"></script>
    {% block theme %} {% endblock theme %}
    <link href="{% static 'menu/css/menu.css' %}" rel="stylesheet" />

    <link rel="stylesheet" href="{% static 'menu/css/reset.css' %}">
    <!-- CSS reset -->
    <link rel="stylesheet" href="{% static 'menu/css/style.css' %}">
    <script src="https://kit.fontawesome.com/d95622ef16.js" crossorigin="anonymous"></script>
    {% block head %} {% endblock head %}

    <style>
        .added-to-fav,
        .added-to-cart {
            background-color: white !important;
        }
    </style>
    {% block css %}{% endblock css %}

    <style>
        .selected-size {
            border: 2px solid black !important;
        }


        .selected-color {
            border: 2px solid black !important;
        }

        @media screen and (max-width: 1000px) {
            .product-grid .social {
                opacity: 1;
                top: 50%;
            }

        }
    </style>

</head>

<body>




    <nav class="breadcrumbs">
        <a href="index.html" class="breadcrumbs__item">
            Home
        </a>
        <span class="breadcrumbs__separator" aria-hidden="true"></span>
        <span>{% block breadcrumb %}{% endblock breadcrumb %}</span>
    </nav>
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <div class="alert alert-{{message.tags}} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </ul>
    {% endif %}

    <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
        aria-hidden="true">
        <div style="width: 85% !important; max-width: unset; height: 90%; max-height: unset;     margin: auto;"
            class="modal-dialog modal-lg">
            <div style="min-height: 100%; display: flex; justify-content: center; align-items: center;"
                id="product-modal" class="modal-content">
                <div class="d-flex justify-content-center">
                    <div class="spinner-border" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>



    {% block content %}

    {% endblock content %}




    <!-- Footer Section Begin -->
    <footer class="footer-social-icons">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="footer-left" id="footer-left">

                        <div class="footer-social">
                            <h6>FOLLOW US</h6>
                            <a href="https://www.instagram.com/souk.ca/" target="_blank"><i
                                    class="fab fa-instagram"></i></a>
                            <a href="#"><i class="fab fa-facebook"></i></a>
                            <a href="#"><i class="fab fa-pinterest"></i></a>
                            <a href="#"><i class="fab fa-linkedin"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <section class="home-newsletter">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <div class="single">
                        <h2>Sign up for souk news</h2>
                        <form action="/news-sign-up/" method="POST" class="input-group">
                            {% csrf_token %}
                            <input name="subEmail" type="email" class="form-control" placeholder="Enter your email">
                            <span class="input-group-btn">
                                <button class="btn btn-theme" type="submit">Subscribe</button>
                            </span>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer-section" id="footer-section">
        <div class="container">
            <div class="row l-r-sp">
                <div class="col-lg-3">
                    <div class="footer-widget">
                        <ul>
                            <li><a href="souk_centre.html">Shop</a></li>

                        </ul>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="footer-widget">
                        <ul>
                            <li><a href="souk_centre.html">Sell</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="footer-widget">
                        <ul>
                            <li><a href="souk_centre.html">About</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="footer-widget">
                        <ul>
                            <li><a href="souk_centre.html">Help</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </footer>

    <div class="wrapper">
        <section class="columns">
            <div class="column text-white copyright-text__align">
                &copy;
                <script>
                    document.write(new Date().getFullYear());
                </script> souk All Rights Reserved
            </div>
            <div class="column">
                <div class="last-links text-center">
                    <li><a href="privacy_policy.html">Privacy Policy</a> | </li>
                    <li><a href="terms_of_service.html">Terms of Service</a></li>
                </div>
            </div>
            <div class="column">
                <div class="payment-pic">
                    <img src="img/payment-method.png" alt="payment_method_picture">
                </div>
            </div>
        </section>
    </div>

    <script>

        {% if not user.is_authenticated %}
        if (localStorage.getItem('favorites') == null) {
            localStorage.setItem('favorites', '[]')
        }
        if (localStorage.getItem('cart') == null) {
            localStorage.setItem('cart', '[]')
        }
        if (localStorage.getItem('cartId') == null) {
            localStorage.setItem('cartId', '[]')
        }
        {% else %}
        document.getElementById('logout').addEventListener('click', () => {
            document.getElementById('logout-form').submit()
        })
        {% endif %}
    </script>


    <script>


        function removeActiveFav(className, loggedin = false) {
            let id = className
            let favButton = document.getElementsByClassName(className)
            Array.from(favButton).forEach(e => {
                if (loggedin == true) {
                    e.setAttribute('onclick', `addToWishlist(this, ${id})`)
                }
                e.setAttribute('data-tip', 'Add To Favorites')
                e.classList.remove('added-to-fav')
            });
        }
        function addActiveFav(className, loggedin = false) {
            let id = className
            let favButton = document.getElementsByClassName(className)
            Array.from(favButton).forEach(e => {
                if (loggedin == true) {
                    e.setAttribute('onclick', `removeFromWishlist(this, ${id})`)
                }
                e.setAttribute('data-tip', 'Remove From Favorites')
                e.classList.add('added-to-fav')
            });
        }




        function removeActiveCart(className, loggedin = false) {
            let id = className
            let favButton = document.getElementsByClassName(`cart-${className}`)
            Array.from(favButton).forEach(e => {

                e.setAttribute('onclick', `addToCart(this, ${id})`)
                e.setAttribute('data-tip', 'Add To Cart')
                e.classList.remove('added-to-cart')
            });
        }
        function addActiveCart(className, loggedin = false) {
            let id = className
            let favButton = document.getElementsByClassName(`cart-${className}`)
            Array.from(favButton).forEach(e => {

                e.setAttribute('onclick', `removeFromCart(this, ${id})`)
                e.setAttribute('data-tip', 'Remove From Cart')
                e.classList.add('added-to-cart')
            });
        }


        {% if not user.is_authenticated %}
        // for loggedout user 


        // for wishlist 

        let allProds = document.getElementsByClassName('logged-out-item')
        let allLocalFav = JSON.parse(localStorage.getItem('favorites'))
        document.getElementById('wishlist-count-number').innerHTML = Array.from(allLocalFav).length

        Array.from(allProds).forEach(e => {
            if (allLocalFav.includes(parseInt(e.id))) {
                e.setAttribute('data-tip', 'Remove From Favorites')
                e.classList.add('added-to-fav')
            }
            else {
                e.setAttribute('data-tip', 'Add To Favorites')
                e.classList.remove('added-to-fav')
            }
        });

        function toggleInLocalWishlist(e, id) {
            // console.log(`${id}  and this is adding to local wishlist`)
            let localFav = JSON.parse(localStorage.getItem('favorites'))
            if (localFav.includes(id)) {
                localFav.splice(localFav.indexOf(id), 1)
                removeActiveFav(id)
                if (document.getElementById(`${id}-remove-cart-item`) != null) {
                    if (e.innerHTML == 'Move To Wishlist') {
                        e.innerHTML = 'Remove From Wishlist'
                    }
                    else {
                        e.innerHTML = 'Move To Wishlist'
                    }
                }
                e.setAttribute('data-tip', 'Removed Successfully')
                e.classList.remove('added-to-fav')
                document.getElementById('wishlist-count-number').innerHTML = localFav.length
                setTimeout(() => {
                    e.setAttribute('data-tip', 'Add To Favorites')

                }, 1000);
            }
            else {

                localFav.push(id)
                addActiveFav(id)
                e.setAttribute('data-tip', 'Added Successfully')
                e.classList.add('added-to-fav')
                document.getElementById('wishlist-count-number').innerHTML = localFav.length
                setTimeout(() => {
                    e.setAttribute('data-tip', 'Remove From Favorites')

                }, 1000);
                if (document.getElementById(`${id}-remove-cart-item`) != null) {
                    if (e.innerHTML == 'Remove From Wishlist') {
                        e.innerHTML = 'Move To Wishlist'
                    }
                    else {
                        e.innerHTML = 'Remove From Wishlist'
                    }
                }
            }
            localStorage.setItem('favorites', JSON.stringify(localFav))
            console.log(JSON.parse(localStorage.getItem('favorites')))
        }



        // for cart 

        let allProdsCart = document.getElementsByClassName('logged-out-item-cart')
        let allLocalCartIds = JSON.parse(localStorage.getItem('cartId'))
        document.getElementById('cart-count-number').innerHTML = Array.from(allLocalCartIds).length
        console.log(Array.from(allProdsCart));
        Array.from(allProdsCart).forEach(e => {

            if (allLocalCartIds.includes(parseInt(e.id.replace('cart-', '')))) {
                e.setAttribute('data-tip', 'Remove From Cart')
                e.classList.add('added-to-cart')
                e.setAttribute('onclick', `removeFromCart(this,${e.id.replace('cart-', '')})`)

            }
            else {
                e.setAttribute('data-tip', 'Add To Cart')
                e.classList.remove('added-to-cart')
                e.setAttribute('onclick', `addToCart(this, ${e.id.replace('cart-', '')})`)
            }



        });



        function toggleInLocalCart(e, id) {
            let alreadyInCart = false

            if (document.getElementById(`${id}-remove-cart-item`) != null) {
                let localCart = JSON.parse(localStorage.getItem('cart'))
                let localCartId = JSON.parse(localStorage.getItem('cartId'))
                if (localCartId.includes(id)) {

                    console.log(localCartId.splice(localCartId.indexOf(id), 1))
                    localCart.map(elm => {
                        if (elm.id == id) {
                            localCart.splice(localCart.indexOf(elm), 1)
                        }
                    })
                    localStorage.setItem('cart', JSON.stringify(localCart))
                    localStorage.setItem('cartId', JSON.stringify(localCartId))
                    console.log(JSON.parse(localStorage.getItem('cart')))
                    document.getElementById('cart-count-number').innerHTML = localCart.length
                    document.getElementById(`${id}-remove-cart-item`).remove()

                    alreadyInCart = true


                }
                return ''
            }
            console.log(id);
            let selectedSize = document.getElementsByClassName('selected-size')[0]
            let selectedColor = document.getElementsByClassName('selected-color')[0]
            if (selectedSize == undefined) {
                document.getElementById('size-not-selected').style.display = 'inline'
            }
            else {
                let elm = document.getElementById('size-not-selected')
                if (elm != null) {
                    elm.style.display = 'none'
                }

            }
            if (selectedColor == undefined) {
                document.getElementById('color-not-selected').style.display = 'inline'
            }
            else {
                let elm = document.getElementById('color-not-selected')
                if (elm != null) {
                    elm.style.display = 'none'
                }
            }
            if (selectedSize != undefined && selectedColor != undefined) {


                console.log(e)
                console.log(id)
                let localCart = JSON.parse(localStorage.getItem('cart'))
                let localCartId = JSON.parse(localStorage.getItem('cartId'))

                if (localCartId.includes(id)) {
                    localCartId.splice(localCartId.indexOf(id), 1)
                    localCart.map(elm => {
                        if (elm.id == id) {
                            localCart.splice(localCart.indexOf(elm), 1)
                        }
                    })
                    if (document.getElementById(`${id}-remove-cart-item`) != null) {
                        document.getElementById(`${id}-remove-cart-item`).remove()
                    }
                    let alreadyInCart = true


                }

                if (alreadyInCart == false) {
                    let cartItem = {
                        id: id,
                        size: document.getElementsByClassName('selected-size')[0].id,
                        color: document.getElementsByClassName('selected-color')[0].id
                    }
                    localCart.push(cartItem)
                    localCartId.push(id)
                    addActiveCart(id)
                    localStorage.setItem('cart', JSON.stringify(localCart))
                    localStorage.setItem('cartId', JSON.stringify(localCartId))
                    console.log(JSON.parse(localStorage.getItem('cart')))
                    document.getElementById('cart-count-number').innerHTML = localCart.length

                    $('.bd-example-modal-lg').modal('toggle')

                }



            }








        }

        {% else %}
        // for favourate or wishlisdt 
        function addToWishlist(e, id) {
            console.log(id);


            const data = { product_id: id };

            fetch("http://127.0.0.1:8000/api/favorites/", {
                method: "PATCH", // or 'PUT'
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.loggedin == false) {
                        window.location = '/login'
                    }
                    if (data.status == true) {
                        addActiveFav(id, true)
                        // this code will runn in only cart page
                        if (document.getElementById(`${id}-remove-cart-item`) != null) {
                            if (e.innerHTML = 'Move To Wishlist') {
                                e.innerHTML = 'Remove From Wishlist'
                            }
                            else {
                                e.innerHTML = 'Move To Wishlist'
                            }
                        }

                        e.setAttribute('onclick', `removeFromWishlist(this, ${id})`)
                        e.setAttribute('data-tip', 'Added Successfully')
                        console.log("Success:", data);
                        e.classList.add('added-to-fav')
                        document.getElementById('wishlist-count-number').innerHTML = data.len_favorites
                        setTimeout(() => {
                            e.setAttribute('data-tip', 'Remove From Favorites')

                        }, 1000);


                    }
                    else {
                        e.setAttribute('data-tip', 'Failed To add ')
                        setTimeout(() => {
                            e.setAttribute('data-tip', 'Add To Favorites')

                        }, 1000);

                    }
                })
                .catch((error) => {
                    console.error("Error:", error);
                });

        }

        function removeFromWishlist(e, id) {
            console.log(id);

            const data = { product_id: id };

            fetch("http://127.0.0.1:8000/api/favorites/", {
                method: "DELETE", // or 'PUT'
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.loggedin == false) {
                        window.location = '/login'
                    }
                    console.log(data);
                    if (data.status == true) {
                        removeActiveFav(id, true)

                        if (document.getElementById(`${id}-remove-cart-item`) != null) {
                            if (e.innerHTML = 'Remove From Wishlist') {
                                e.innerHTML = 'Move To Wishlist'
                            }
                            else {
                                e.innerHTML = 'Remove From Wishlist'
                            }
                        }

                        e.setAttribute('onclick', `addToWishlist(this, ${id})`)


                        e.setAttribute('data-tip', 'Removed Successfully')
                        console.log("Success:", data);
                        e.classList.remove('added-to-fav')
                        document.getElementById('wishlist-count-number').innerHTML = data.len_favorites
                        setTimeout(() => {
                            e.setAttribute('data-tip', 'Add To Favorites')

                        }, 1000);


                    }
                    else {
                        e.setAttribute('data-tip', 'Failed To remove ')
                        setTimeout(() => {
                            e.setAttribute('data-tip', 'Remove From Favorites')

                        }, 1000);

                    }
                })
                .catch((error) => {
                    console.error("Error:", error);
                });

        }


        // for cart 

        function addToCartUsingApi(e, id) {
            console.log(e);
            console.log(id);
            let selectedSize = document.getElementsByClassName('selected-size')[0]
            let selectedColor = document.getElementsByClassName('selected-color')[0]
            if (selectedSize == undefined) {
                document.getElementById('size-not-selected').style.display = 'inline'
            }
            else {
                let elm = document.getElementById('size-not-selected')
                if (elm != null) {
                    elm.style.display = 'none'
                }

            }
            if (selectedColor == undefined) {
                document.getElementById('color-not-selected').style.display = 'inline'
            }
            else {
                let elm = document.getElementById('color-not-selected')
                if (elm != null) {
                    elm.style.display = 'none'
                }
            }
            if (selectedSize != undefined && selectedColor != undefined) {
                const data = {
                    product_id: id,
                    selected_size: document.getElementsByClassName('selected-size')[0].id,
                    selected_color: document.getElementsByClassName('selected-color')[0].id
                };
                console.log(data);

                fetch("http://127.0.0.1:8000/api/cart/", {
                    method: "PATCH", // or 'PUT'
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(data),
                })
                    .then((response) => response.json())
                    .then((data) => {
                        console.log(data);
                        if (data.loggedin == false) {
                            window.location = '/login'
                        }
                        if (data.status == true) {
                            addActiveCart(id, true)

                            $('.bd-example-modal-lg').modal('toggle')
                            document.getElementById('cart-count-number').innerHTML = data.len_cart
                            document.getElementById('product-modal').innerHTML = `

                                <div class="d-flex justify-content-center">
            <div class="spinner-border" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
                        
                        `


                        }
                        else {


                        }
                    })
                    .catch((error) => {
                        console.error("Error:", error);
                    });
            }



        }






        {% endif %}

        function selectColor(e, id) {
            // console.log(e.target)
            console.log()
            Array.from(e.parentElement.children).forEach(element => {
                element.classList.remove(`selected-color`)
                // console.log(`selected-color`)
            });
            e.classList.add(`selected-color`)

        }

        function selectSize(e, id) {
            console.log()
            Array.from(e.parentElement.children).forEach(element => {
                element.classList.remove(`selected-size`)
                console.log(element);
            });
            e.classList.add(`selected-size`)
        }






        function addToCart(e, id) {
            console.log(e);
            console.log(id);
            $('.bd-example-modal-lg').modal('toggle')

            const data = { product_id: id };

            fetch("http://127.0.0.1:8000/api/product/", {
                method: "POST", // or 'PUT'
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.loggedin == false) {
                        window.location = '/login'
                    }
                    if (data.status == true) {
                        console.log(data);
                        document.getElementById('product-modal').innerHTML = `
                        
                        <div class="page-wrapper mt-1">
                            <div class="container-fluid pl-lg-0 padding-right-lg">

                                <div class="product-single-container product-single-default">
                                    <div class="row">
                                        <div class="col-lg-7 product-single-gallery">
                                            <div class="sticky-slider">
                                                <div class="product-slider-container">
                                                    <div class="product-single-carousel owl-carousel owl-theme" id="owl-carousel">
                                                        <div class="product-item">
                                                            <img class="product-single-image"
                                                                src="https://cdn.shopify.com/s/files/1/0293/9277/products/10-07-19_Studio_3_JP_RE_11-59-24_19__VID9250_Mocha_0993_JK_760x.jpg?v=1572888051" />
                                                        </div>
                                                        <div class="product-item">
                                                            <img class="product-single-image"
                                                                src="https://cdn.shopify.com/s/files/1/0293/9277/products/SwipingCardsHoodedShortSet-Black_MER_760x.jpg?v=1597857117" />
                                                        </div>
                                                        <div class="product-item">
                                                            <img class="product-single-image"
                                                                src="https://cdn.shopify.com/s/files/1/0293/9277/products/07-16-20_NovaVintage_BR6-02AM_49_ID2662_Taupe_R_1154__RA_760x.jpg?v=1602111656" />
                                                        </div>

                                                        <div class="product-item">
                                                            <img class="product-single-image"
                                                                src="https://cdn.shopify.com/s/files/1/0293/9277/products/KatherineRibbedSweaterDress-Taupe_MER_760x.jpg?v=1602111656" />
                                                        </div>
                                                        <div class="product-item">
                                                            <img class="product-single-image" src="assets/images/shop-4.jpg" />
                                                        </div>
                                                        <div class="product-item">
                                                            <img class="product-single-image" src="assets/images/shop-5.jpg" />
                                                        </div>
                                                    </div>
                                                    <!-- End .product-single-carousel -->
                                                    <!-- <span class="prod-full-screen">
                                                                <i class="icon-plus"></i>
                                                            </span> -->
                                                </div>

                                                <div class="prod-thumbnail owl-dots transparent-dots flex-column" id='carousel-custom-dots'>
                                                    <div class="owl-dot">
                                                        <img src="{% static 'home/product/m.jpg' %} " />
                                                    </div>

                                                    <div class="owl-dot">
                                                        <img src="{% static 'home/assets/images/shop-2.jpg' %} " />
                                                    </div>
                                                    <div class="owl-dot">
                                                        <img
                                                            src="https://cdn.shopify.com/s/files/1/0293/9277/products/07-16-20_NovaVintage_BR6-02AM_49_ID2662_Taupe_R_1154__RA_760x.jpg?v=1602111656" />
                                                    </div>
                                                    <div class="owl-dot">
                                                        <img src="{% static 'home/assets/images/shop-4.jpg' %} " />
                                                    </div>
                                                    <div class="owl-dot">
                                                        <img src="{% static 'home/assets/images/shop-6.jpg' %} " />
                                                    </div>
                                                    <div class="owl-dot">
                                                        <img src="{% static 'home/assets/images/shop-7.jpg' %} " />
                                                    </div>
                                                </div>
                                            </div>
                                        </div><!-- End .col-lg-6 -->

                                        <div class="col-lg-5" id="single-product">
                                            <div class="info">
                                                <div class="product-single-Name">
                                                    <h3 class="small">${data.brand}</h3>
                                                    <div>
                                                        <h1 class="big">${data.name}</h1>
                                                        <!-- <span class="new">new</span> -->
                                                    </div>

                                                </div>
                                                <div class="review-stars">
                                                    <span class="fa fa-star"></span>
                                                    <span class="fa fa-star"></span>
                                                    <span class="fa fa-star"></span>
                                                    <span class="fa fa-star"></span>
                                                    <span class="fa fa-star"></span>
                                                    <span style="display: inline-block;">
                                                        <h6 style="text-decoration: underline;">12 Reviews</h6>
                                                    </span>
                                                </div>
                                                <div class="price">
                                                    <h1>                           ${data.discount_price == '0' ? data.price + ' BDT' : (data.price - data.discount_price) + ' BDT <br>' + '<s>' + data.price + ' BDT</s>'

                            }</h1>
                                                </div>
                                                <div class="price">
                                                    <h5 style="font-size: 12px; color: #3a3a3a; font-weight: bold;"> Delivery cost: ${data.delivery_cost}</h5>
                                                </div>
                                                <!-- <div class="description">
                                                                <h3 class="title">Product Info</h3>
                                                                <p class="text">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's.</p>
                                                            </div> -->
                                                
                                                   

                                                ${data.color.length != 0 ?
                                `
                                                    <div class="color-container"  ><h3 class="title"><span>Color </span>  <span style="color:red; display:none;"  id="color-not-selected"> * Please Select A Color</span> </h3>
                                                        <div class="colors" id="colors">
                                                        ${data.color.map(code => {
                                    return '<span  onclick="selectColor(this, ' + data.id + ')"  class="color select-color" id="' + code + '" style="background: #' + code + '; border: 1px solid #00000033;" ></span>'
                                })
                                }
                                                        
                                                    </div>
                                                    </div>
                                                    `: '<span style="display:none" class="selected-color"></span>'
                            }

                                                
                                                ${data.size.length != 0 ?
                                `
                                                    <div class="size-container">
                                                    <h3 class="title"><span>Size </span>  <span style="color:red;  display:none;" id="size-not-selected"> * Please Select A Size</span> </h3>
                                                    <div class="sizes" id="sizes">
                                                        ${data.size.map(size => {
                                    return `<span  id="${size}"  onclick="selectSize(this, ${data.id})" class="size  select-size">${size}</span>`
                                })
                                }
                                                        
                                                    </div>
                                                    </div>
                                                    `: '<span  style="display:none"  class="selected-size"></span>'
                            }
      
                                                <div class="buy-price">
                                                    <a  onClick="{% if user.is_authenticated %}addToCartUsingApi(this, ${data.id}){% else %}toggleInLocalCart(this, ${data.id}){% endif %}" href="javascript:void(0)" class="buy">Add to bag</a>
                                                </div>
                                                <div class="buy-price mt-2">
                                                    <a href="#" class="buy">Quick checkout</a>
                                                </div>


                                                <section class="accordion accordion-1">
                                                    <input type="checkbox" name="collapse" id="handle1" checked="checked">
                                                    <h5 class="handle">
                                                        <label for="handle1">Product details</label>
                                                    </h5>
                                                    <div class="content">
                                                        ${data.product_details}

                                                    </div>
                                                </section>
                                                <section class="accordion">
                                                    <input type="checkbox" name="collapse2" id="handle2">
                                                    <h2 class="handle">
                                                        <label for="handle2">Shipping information</label>
                                                    </h2>
                                                    <div class="content">
                                                        ${data.shipping_information}
                                                    </div>
                                                </section>
                                                <section class="accordion">
                                                    <input type="checkbox" name="collapse2" id="handle3">
                                                    <h2 class="handle">
                                                        <label for="handle3">Return policy</label>
                                                    </h2>
                                                    <div class="content">
                                                        ${data.return_policy}

                                                    </div>
                                                </section>

                                            </div>
                                        </div>
                                    </div><!-- End .col-lg-6 -->
                                </div><!-- End .row -->
                            </div><!-- End .product-single-container -->
                        </div>

                        
                        `


                    }
                    else {
                        e.setAttribute('data-tip', 'Failed To add')
                        setTimeout(() => {
                            e.setAttribute('data-tip', 'Add To Cart')

                        }, 1000);

                    }
                })
                .catch((error) => {
                    console.error("Error:", error);
                });




        }

        function removeFromCart(e, id) {


            {% if user.is_authenticated %}
            const data = { product_id: id };

            fetch("http://127.0.0.1:8000/api/cart/", {
                method: "DELETE", // or 'PUT'
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.loggedin == false) {
                        window.location = '/login'
                    }
                    console.log(data);
                    if (data.status == true) {
                        removeActiveCart(id, true)

                        // this code will runn in only cart page
                        if (document.getElementById(`${id}-remove-cart-item`) != null) {
                            document.getElementById(`${id}-remove-cart-item`).remove()
                        }

                        e.setAttribute('onclick', `addToCart(this, ${id})`)


                        e.setAttribute('data-tip', 'Removed Successfully')
                        console.log("Success:", data);
                        e.classList.remove('added-to-cart')
                        document.getElementById('cart-count-number').innerHTML = data.len_cart
                        setTimeout(() => {
                            e.setAttribute('data-tip', 'Add To Cart')

                        }, 1000);


                    }
                    else {
                        e.setAttribute('data-tip', 'Failed To remove ')
                        setTimeout(() => {
                            e.setAttribute('data-tip', 'Remove From Cart')

                        }, 1000);

                    }
                })
                .catch((error) => {
                    console.error("Error:", error);
                });



            {% else %}

            let localCart = JSON.parse(localStorage.getItem('cartId'))
            let localCartItems = JSON.parse(localStorage.getItem('cart'))
            if (localCart.includes(id)) {
                localCart.splice(localCart.indexOf(id), 1)
                localCartItems.map(elm => {
                    if (elm.id == id) {
                        localCartItems.splice(localCartItems.indexOf(elm), 1)
                    }
                })
                removeActiveCart(id)

                if (document.getElementById(`${id}-remove-cart-item`) != null) {
                    document.getElementById(`${id}-remove-cart-item`).remove()
                }



                e.setAttribute('data-tip', 'Removed Successfully')
                e.classList.remove('added-to-cart')
                document.getElementById('cart-count-number').innerHTML = localCart.length
                setTimeout(() => {
                    e.setAttribute('data-tip', 'Add To Cart')

                }, 1000);
            }

            localStorage.setItem('cartId', JSON.stringify(localCart))
            localStorage.setItem('cart', JSON.stringify(localCartItems))
            console.log(JSON.parse(localStorage.getItem('cart')))


            {% endif %}


        }

    </script>



    {% block js %}{% endblock js %}


    <script src="{% static 'menu/js/jquery.mobile.custom.min.js' %}"></script>
    <script src="{% static 'menu/js/main.js' %}"></script>
    <!-- Resource jQuery -->

    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/jquery.slicknav.js' %}"></script>
    <!-- For hero slider-->
    <script src="{% static 'js/owl.carousel.min.js' %}"></script>
    <!-- For hero slider-->
    <script src="{% static 'js/main2.js' %}"></script>
    <script src="{% static 'js/custom.js' %}"></script>
    <script src="{% static 'js/index.js' %}"></script>
    <script src="{% static 'assets/js/bootstrap.min.js' %}"></script>




</body>

</html>